[Unity - グラフィックの目次へ](./../index.md)

### マテリアルとシェーダの基礎

Unityで何かしらの物体（正確にはポリゴンだが、ここでは物体と呼ぶ）を表示させる時、それに対して「マテリアル」を設定する必要がある。

例えば「赤いプラスチックのボール」の物体を出現させる場合、「赤い」「プラスチックのような光沢」の情報を持ったマテリアルを、その物体に対して適用する。

具体的に、「赤いプラスチック」をどのように表示するかは、マテリアルの中に含まれる「シェーダ」が決める。

「シェーダ」は、面の頂点や法線といった情報から、その物体をどのように表示すべきかを計算してコンピュータに伝えるプログラムである。

シェーダは、パラメータを持つことが出来る。例えば先の「赤いプラスチックの材質」であれば、
「青いプラスチック」「緑のプラスチック」などごとにシェーダを用意するのは不合理であり、シェーダとして考えられるのは
「色」をパラメータとして持ち、「プラスチックの材質」を計算するシェーダである。

シェーダに与えるパラメータは、マテリアルごとに決めることができる。
逆に言えば、シェーダに与えたいパラメータの種類だけ、マテリアルを作る必要がある。

シェーダは「色をパラメータとして持つプラスチック材質のシェーダ」1つだが、マテリアルは「そのシェーダに「赤」のパラメータを渡すマテリアル」「そのシェーダに「青」のパラメータを渡すマテリアル」などと、パラメータのバリエーションの数だけ準備する必要がある。

マテリアルは、「シェーダ」と、「そのシェーダに使うパラメータ」の組み合わせであると覚えると良い。

### Universal Render Pipeline/Litシェーダ（およびStandardシェーダ）

ここではレンダリング方法としてURPを使用しているが、URPのシェーダの1つに「Universal Render Pipeline/Litシェーダ」（以下、URP/Lit）というものがある。

URP/Litは、現実の物理法則を踏まえて、様々な材質を1つのシェーダで表現できるようにしたシェーダである。

URP/Litはパラメータをいくつも持ち、そのパラメータにより質感を変えることができる。

これを使えば、「革のマテリアル」「金属のマテリアル」などを1つのシェーダから作ることが出来る（マテリアルはその数だけ作る必要がある）。

URP/Litは、Blenderで設定したマテリアルをUnityに持ってくる時に、Blenderで作成したマテリアルに対して自動で割り当てられるシェーダでもある。

補足として、Blenderでトゥーンなどの特殊なシェーダを作成しても、fbxにはシェーダの情報は含まれないため、
Unity側ではどのマテリアルに対してもスタンダードシェーダが割り当てられる。

ただし、Blenderのマテリアル設定のうち、Diffuse（拡散光）などのパラメータはUnityでも認識することができ、
URP/LitのマテリアルのパラメータとしてUnityにインポートされる。

### マテリアルのパラメータの変更

マテリアルのパラメータは、プログラムからも変更することができる。

詳細は省略するが、「白いプラスチック」のマテリアルの中の「色」のパラメータを徐々に変化させることで、時間と共に色が変化するプラスチックを作ることができる。

ただし、注意点は、マテリアルは、そのマテリアルを設定している全ての物体で共有されているということである。

従って、100個の白いプラスチックボールのうちの1つの色を変えようと、そのボールのマテリアルの色を変更すると、全てのボールの色が同時に変わってしまう。

（ついでに言えば、Playモードでマテリアルのパラメータを変えると、Editモードに戻っても反映されたままになる）

これを防ぐには、マテリアルのパラメータを変える前に、マテリアルを複製し、その複製したマテリアルを改めて物体に割り当て、パラメータを変更する。

イメージが湧かないかも知れないが、実際に「マテリアルのパラメータを変更する」時になったら思い出そう。
